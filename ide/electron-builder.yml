appId: com.kimivscode.ide
productName: Kimi VSCode

# Build directories
directories:
  output: release
  buildResources: build

# Files to include
files:
  - dist/**/*
  - build/**/*
  - assets/**/*
  - package.json
  - '!**/node_modules/*/{CHANGELOG.md,README.md,README,readme.md,readme}'
  - '!**/node_modules/*/{test,__tests__,tests,powered-test,example,examples}'
  - '!**/node_modules/*.d.ts'
  - '!**/node_modules/.bin'
  - '!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}'
  - '!.editorconfig'
  - '!**/._*'
  - '!**/{.DS_Store,.git,.hg,.svn,CVS,RCS,SCCS,.gitignore,.gitattributes}'
  - '!**/{__pycache__,thumbs.db,.flowconfig,.idea,.vs,.nyc_output}'
  - '!**/{appveyor.yml,.travis.yml,circle.yml}'
  - '!**/{npm-debug.log,yarn.lock,.yarn-integrity,.yarn-metadata.json}'

# Extra resources to copy
extraResources:
  - from: assets
    to: assets
    filter:
      - '**/*'

# macOS configuration
mac:
  category: public.app-category.developer-tools
  icon: assets/icon.icns
  target:
    - target: dmg
      arch:
        - x64
        - arm64
    - target: zip
      arch:
        - x64
        - arm64
  hardenedRuntime: true
  gatekeeperAssess: false
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  
  # Code signing (optional - only if certificate is available)
  # identity: "Developer ID Application: Your Name (TEAM_ID)"
  
  # Notarization (for macOS 10.15+)
  # Note: Requires Apple Developer account
  notarize:
    appBundleId: com.kimivscode.ide
    # teamId: TEAM_ID

# DMG configuration
dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications
  window:
    width: 540
    height: 380
  backgroundColor: '#f0f0f0'
  iconSize: 128

# Windows configuration
win:
  target:
    - target: nsis
      arch:
        - x64
        - ia32
  icon: assets/icon.ico
  publisherName: Kimi VSCode Team
  verifyUpdateCodeSignature: false

# NSIS installer configuration
nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
  createStartMenuShortcut: true
  shortcutName: Kimi VSCode
  installerIcon: assets/icon.ico
  uninstallerIcon: assets/icon.ico
  installerHeaderIcon: assets/icon.ico

# Linux configuration
linux:
  target:
    - AppImage
    - deb
    - rpm
  icon: assets/icons
  category: Development
  maintainer: Kimi VSCode Team
  vendor: Kimi VSCode
  synopsis: Modern IDE built with Electron and React
  description: |
    Kimi VSCode is a modern, lightweight IDE built with Electron and React.
    It provides a fast and extensible development environment.

# Auto-update configuration
publish:
  provider: github
  owner: kimi-vscode
  repo: ide
  # private: true
  # token: ${GITHUB_TOKEN}

# Protocol handler (deep linking)
protocols:
  - name: Kimi VSCode Protocol
    schemes:
      - kimivscode

# Compression level
compression: maximum

# Asar packaging
asar: true
asarUnpack:
  - '**/*.node'
  - 'assets/**/*'

# NPM rebuild
npmRebuild: true

# Electron version (optional - will use devDependencies if not specified)
# electronVersion: 28.0.0

# After pack hook
afterPack: './build/afterPack.js'

# Before build hook
beforeBuild: './build/beforeBuild.js'
